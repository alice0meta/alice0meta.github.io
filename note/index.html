<!DOCTYPE html><html manifest="cache.manifest"><head><meta charset="utf-8">
	<title>alice » note</title>
	<style>
		/* should be templated in */
		body {background-color: #222; color: #fff; font-family: "Verdana"; font-size: 13px;}
		a:visited {color: #bb7f00;}
		a:hover, a:active, a:focus {color: #eeeeee;}
		a {color: #ffb200; text-decoration: none;}

		/* stuff */
		#note {margin:20px; font-size:200%; display:block; width:100%; background-color:inherit; color:inherit; border:none; outline:none;}
	</style>
	<script src="https://code.jquery.com/jquery-latest.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
</head><body>
	<a href="/">alice</a> » note
	<input id="note" type="text" autofocus></input>
</body></html>
<script>

var print = console.log.bind(console)

$.on_view = function(f){document.addEventListener('visibilitychange',function(){if (!document.hidden) f()})}
$.on_away = function(f){document.addEventListener('visibilitychange',function(){if (document.hidden) f()})}

// --------- body --------- //

var hash = decodeURIComponent(location.hash.replace(/^#/,''))//.replace(/\+/g,' '))

$('#note').val(hash)
var set_hash = function(){
	hash = $('#note').val()
	document.title = hash || 'alice » note'
	location.hash = '#'+hash
	}
set_hash()

;(function(){
	var λ = function(){
		if (hash !== $('#note').val()) set_hash()
		if (!document.hidden) setTimeout(λ,100) }
	λ()
	$.on_view(λ)
	})()

</script>
